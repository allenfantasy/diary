<!DOCTYPE html><!--[if lte IE 8]>
<html lang="en" class="lte-ie8">
<![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]--><head><meta charset="utf-8"><title>July 29, 2015</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/diary/styles/global.css"><link rel="stylesheet" href="/diary/styles/tomorrow.css"><link rel="stylesheet" href="/diary/styles/diary.css"></head><body><header class="header"><div class="index"><a href="/diary/">Index</a></div><h1>July 29, 2015</h1></header><div class="content"><div class="diary"><h2 id="js">JS</h2>
<p>How to do sth before submitting a form in jQuery:</p>
<pre><code class="lang-js">$(<span class="hljs-string">'#form'</span>).submit(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Do something, like setting values for input:hidden</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// or false to cancel form action.</span>
});
</code></pre>
<p>The question is: <strong>HOW jQuery do this?</strong></p>
<h3 id="-submit-"><code>.submit()</code></h3>
<p>It took me nearly <strong>40mins</strong> to find out (digging in jQuery&#39;s source), it&#39;s a really simple <code>addEventListener</code> problem, coz we already have <code>onsubmit</code> event.</p>
<p>The following snippet do almost the same thing <code>.submit()</code> do:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> ele = <span class="hljs-comment">/*Your Form Element*/</span>;
<span class="hljs-keyword">if</span>(ele.addEventListener){
    ele.addEventListener(<span class="hljs-string">"submit"</span>, callback, <span class="hljs-literal">false</span>);  <span class="hljs-comment">//Modern browsers</span>
}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ele.attachEvent){
    ele.attachEvent(<span class="hljs-string">'onsubmit'</span>, callback);            <span class="hljs-comment">//Old IE</span>
}
</code></pre>
<p>If there&#39;s something jQuery have done in extra, check <em>L1509</em> in jquery.js (v1.7.2).</p>
<p>You may love that but it&#39;s BORING.</p>
</div></div><footer class="footer"><address class="author">Copyright &copy;<a rel="author" href="https://github.com/allenfantasy" class="author-name">Allen Wu</a>-<a href="https://github.com/allenfantasy/my-tech-diary" class="source-repo">Source</a></address><p>Generated by<a href="https://github.com/joyeecheung/diary" class="site-repo">Joyee Cheung&#39;s diary generator</a></p></footer></body></html>